<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>剪辑师项目管理系统 · Life_HAN</title>
  <link rel="stylesheet" href="./styles.css?v=ui2" />
  <!-- Supabase JS -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
</head>
<body>
<header class="topbar">
  <h1 id="app-title">剪辑师项目管理系统 <span class="badge-gold">Life_HAN</span></h1>
  <nav class="nav">
    <button id="btn-home" class="nav-btn" aria-current="page">首页</button>
    <button id="btn-projects" class="nav-btn">项目</button>
    <button id="btn-schedule" class="nav-btn">档期</button>
    <button id="btn-gallery" class="nav-btn">作品合集</button>
    <button id="btn-finance" class="nav-btn">财务</button>
    <button id="btn-logout" class="nav-btn ghost">退出登录</button>
  </nav>
</header>

<main id="view-home" class="view active">
  <!-- KPI 财务概览 -->
  <section class="kpis">
    <div class="kpi">
      <div class="kpi-label">已收款</div>
      <div id="kpi-paid" class="kpi-value">¥0</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">已收定金</div>
      <div id="kpi-deposit" class="kpi-value">¥0</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">未收款</div>
      <div id="kpi-unpaid" class="kpi-value">¥0</div>
    </div>
  </section>

  <!-- 最近项目 -->
  <section class="card">
    <div class="card-header">
      <h2>最近项目</h2>
      <button class="btn-ghost" id="go-list">查看全部</button>
    </div>
    <div id="recent-list" class="list"></div>
  </section>

  <!-- 成本计算器（已修复点击跳回登录问题） -->
  <section class="card">
    <div class="card-header"><h2>成本计算器</h2></div>
    <form id="calc-form" class="calc-grid">
      <label>报价（含/不含税均可）<input type="number" step="0.01" id="quote" /></label>
      <label>定金<input type="number" step="0.01" id="deposit" /></label>
      <label>已收尾款<input type="number" step="0.01" id="paid" /></label>
      <button type="submit" class="btn">计算</button>
      <div class="calc-result" id="calc-result">—</div>
    </form>
  </section>
</main>

<!-- 项目列表 -->
<section id="view-projects" class="view">
  <div class="card-header">
    <h2>项目列表</h2>
    <div class="filters">
      <div class="select" data-select>
        <button class="select-btn" data-select-toggle>类型&输出规格</button>
        <div class="select-menu">
          <button data-type="LOOKBOOK@1080p">LOOKBOOK · 1080p</button>
          <button data-type="LOOKBOOK@4K">LOOKBOOK · 4K</button>
          <button data-type="TVC@4K">TVC · 4K</button>
          <button data-type="宣传片@1080p">宣传片 · 1080p</button>
          <button data-type="纪录片@4K">纪录片 · 4K</button>
          <button data-type="花絮@1080p">花絮 · 1080p</button>
          <button data-type="">全部</button>
        </div>
      </div>

      <div class="select" data-select>
        <button class="select-btn" data-select-toggle>支付状态</button>
        <div class="select-menu">
          <button data-pay="paid">已结清</button>
          <button data-pay="deposit">已收定金</button>
          <button data-pay="unpaid">未收款</button>
          <button data-pay="">全部</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 桌面表格 / 小屏自动转卡片，避免横向拖动 -->
  <div id="projects-wrap" class="table-wrap">
    <table id="projects-table" class="table">
      <thead>
      <tr>
        <th>项目</th>
        <th>品牌</th>
        <th>类型&输出规格</th>
        <th>影片条数</th>
        <th>A/B/Final</th>
        <th>支付状态</th>
        <th>报价/定金/实收</th>
        <th>合作制片</th>
        <th>备注</th>
      </tr>
      </thead>
      <tbody id="projects-body"></tbody>
    </table>
  </div>
</section>

<!-- 作品合集 -->
<section id="view-gallery" class="view">
  <div class="card-header"><h2>作品合集</h2></div>
  <div id="gallery-grid" class="gallery"></div>
</section>

<!-- 财务 -->
<section id="view-finance" class="view">
  <div class="card-header"><h2>财务</h2></div>
  <div class="kpis">
    <div class="kpi"><div class="kpi-label">已收款</div><div id="f-paid" class="kpi-value">¥0</div></div>
    <div class="kpi"><div class="kpi-label">已收定金</div><div id="f-deposit" class="kpi-value">¥0</div></div>
    <div class="kpi"><div class="kpi-label">未收款</div><div id="f-unpaid" class="kpi-value">¥0</div></div>
  </div>
  <div id="finance-list" class="list"></div>
</section>

<!-- 档期（使用“档期”按钮触发，日历模态） -->
<div id="schedule-modal" class="modal">
  <div class="modal-dialog">
    <div class="modal-head">
      <h3>档期（日历）</h3>
      <div class="schedule-controls">
        <button id="cal-prev" class="btn-ghost">‹</button>
        <div id="cal-label" class="month-label"></div>
        <button id="cal-next" class="btn-ghost">›</button>
        <button id="cal-close" class="btn-ghost">关闭</button>
      </div>
    </div>
    <div class="calendar">
      <div class="cal-head">
        <span>Mon</span><span>Tue</span><span>Wed</span>
        <span>Thu</span><span>Fri</span><span class="muted">Sat</span><span class="muted">Sun</span>
      </div>
      <div id="cal-grid" class="cal-grid"></div>
      <div class="legend">
        <span class="dot ab">A/B</span>
        <span class="dot final">Final</span>
      </div>
    </div>
  </div>
</div>

<!-- 你的 Supabase 配置（已替换为你提供的值） -->
<script>
  window.SUPABASE_URL = "https://lywlcsrndkturdpgvvnc.supabase.co";
  window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5d2xjc3JuZGt0dXJkcGd2dm5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwOTg1NzUsImV4cCI6MjA3MDY3NDU3NX0.z49xmAaG1ciyMbGPPamoYfiAwFTP0PfX7__K3iRRkhs";
</script>
<script src="./app.js?v=ui2"></script>
</body>
</html>
